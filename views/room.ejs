<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <!-- MDB -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.css" rel="stylesheet" />

    <title>Sequence <%= roomID %></title>
    <style>
        .container-540{
            width:540px;
            margin: auto;
        }
        @media screen and (max-width:576px) {
            .container-540{
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container-540">
        <div class="text-center div-button">
            <button type="button" class="btn btn-primary" onClick="GameInit();" disabled id="StartBtn"> Game Start!! </button>
        </div>
        <%- include ('layout/board.html') %>
    </div>

    <!-- MDB -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.js" ></script>
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js" integrity="sha384-fKnu0iswBIqkjxrhQCTZ7qlLHOFEgNkRmK2vaO/LbTZSXdJfAu6ewRBdwHPhBo/H" crossorigin="anonymous"></script>
    <script>
        const socket = io()
        const roomID = <%= roomID %>;
        let team = -1; //0,1
        let user = -1; //0,1,2,3
        socket.emit("room:join", 
            {
                //gameType: 
                roomID: roomID
            }
        );

        //receive socket
        socket.on("room:full", (data)=>{
            //if(user.IsRoomMaster)
            document.getElementById("StartBtn").disabled = false;
        })
        socket.on("game:randomizeOrder", (data)=>{
            user = data.order;
            team = user%2;
        })
        socket.on("game:start", (data)=>{
            console.log("Start!")
            $(".div-button").hide();
            alert(`순서:${user+1}`)
            //display board
        })
        socket.on("game:placeStone-ACK", (data)=>{
            console.log(data);
            drawStone(data.stone);
            //if(data.accepted)
        })


        //socket function
        function GameInit(){
            socket.emit("game:init", {
                roomID: roomID,
            },
            res=>{
                if(!res.result){
                    alert(res.message);
                    return false;
                }
                    
            })
        }
        function PlaceStone(user, row, col){
            socket.emit(
                "game:placeStone",
                {
                    roomID: roomID,
                    stone: [user, row, col],
                    card: ["heart", 1]
                },
                (res)=>{
                    if(!res.result){
                        alert(res.message);
                        return false;
                    }
                }
            )
        }
        // function callbacked(){
        //     socket.emit("callback", {"id":1, "pw":222}, (res)=>{
        //         console.log(res);
        //     })
        // }
        // function orderCreate(){
        //     socket.emit("order:create", {"id":1, "pw":222})
        // }
    </script>
</body>
</html>
